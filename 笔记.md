## 密码学原理：

## 1、Hash

crypto-currency(加密货币)、哈希

哈希碰撞--->   x=y  -> H(x) ≠H(y)

## 2、Hiding

x->H(x)  但是H(x) -\\->x       不可逆            通常x后加一个随机数取hash   H(x||nonce)

x输入空间足够大，分布均匀

digital equipment of a sealed  envelope

## 3、puzzle friendly

H(block header) <= target

##### 比特币的hash函数:

SHA-256  (Secure Hash Algorithm)

##### 比特币开户：公私钥(非对称加密)  

 公钥加密，私钥解密     都是接收方的，公钥给别人，私钥自己留着解密

## 数据结构：

### 哈希指针

哈希链表是根据每个区块合一起取的哈希

![image-20220905195054244](image/image-20220905195054244.png)

如果红色部分的块被改，那么其他的都会改，后面的都会改，所以只需要保存最后一个结点即可知道其他区块是否改变。

![image-20220905195345963](image/image-20220905195345963.png)

如果接受外来区块，如红色的，查看与该节点相连的区块保存的hash值是否和红块一致

### Merkle Tree

![image-20220905200359226](image/image-20220905200359226.png)

绿色的哈希值和红色的哈希值相结合，依次得出向上，所以只需要看根节点的

因为哈希碰撞原理，全节点的篡改几乎不可能

证明包含某个交易的时间复杂度:log(n)

证明不包含的，最快需要排序时间复杂度加log(n)

## 比特币协议

交易示意图

![image-20220905205148724](image/image-20220905205148724.png)

### 块头和块体

![image-20220905205737456](image/image-20220905205737456.png)

#### block header包含的大多为宏观信息

比特币协议

指向前一块的指针

merkle tree的根哈希值

挖矿的目标阈值target

随机数nonce

#### block body

交易列表

### 全结点-轻结点

full node   -----fully validating node     保存所有信息，验证信息

light node -----只保存block header信息

### distributed consensus(分布式共识)

#### FLP impossiblity result    

asynchronous 网络传输过程中，时延没有上线。即使一个成员faulty(有问题)，也不能达成共识。

#### CAP Theorem

CAP------(consistency)  (availablity)  (partition tolerance)一致性   可用性    分区容错性，三者最多可取两个，无法同时满足

### Consensus in Bitcoin



